<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sticker Generator</title>
  <style>
    body { margin:0; font-family:Segoe UI, Arial, sans-serif; background:#f7f9fc; color:#222; }
    .container{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:40px}
    .card{display:flex;background:#fff;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,.08);overflow:hidden;max-width:980px;width:100%}
    .left{flex:1;background:linear-gradient(135deg,#004aad,#007bff);color:#fff;padding:40px;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}
    .left img{width:120px;margin-bottom:20px;border-radius:10px;background:#fff;padding:10px}
    .left h1{font-size:26px;margin-bottom:10px}
    .left p{font-size:15px;line-height:1.6;opacity:.95}
    .right{flex:1.05;padding:36px}
    .right h2{margin-bottom:20px;font-size:22px;color:#004aad}
    input[type=file], select { width:100%; padding:10px; margin:8px 0 16px; border:1px solid #ddd; border-radius:6px; box-sizing:border-box }
    .checkboxes{ margin-bottom:16px }
    button{background:#007bff;color:#fff;border:none;padding:10px 18px;border-radius:8px;cursor:pointer}
    button:hover{background:#005ecb}

    /* flash message */
    .flashes { list-style:none; padding:10px 12px; margin:0 0 18px 0; border-radius:8px; background: #fff0f0; border:1px solid #f5c6c6; color:#b30000; }
    .flashes li { margin:4px 0; }
    .flash-toast { position:relative; transition:opacity .4s ease, transform .4s ease; }
    .flash-hidden { opacity:0; transform:translateY(-6px); pointer-events:none; }
    #fileError {
  color: #d10000;
  font-weight: 500;
  margin-top: 4px;
}

  </style>
</head>
<body>

  <div class="container">
    <div class="card">

      <div class="left">
        <img src="https://www.msgoilfield.com/logo.png" alt="Logo">
        <h1>Sticker Generator</h1>
        <p>Generate printable PDF stickers easily from your Excel file. Choose font, add QR code, and download with a single click.</p>
      </div>

      <div class="right">
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul id="flashes" class="flashes">
        {% for msg in messages %}
          <li class="flash-toast">{{ msg }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

        <h2>Upload Excel File</h2>

       <form id="upload_form" action="{{ url_for('generate') }}" method="post" enctype="multipart/form-data">
  <label>Choose Excel (.xlsx) File</label>
  <!-- removed `required` so browser doesn't show its tooltip -->
  <input type="file" name="excel_file" id="excel_file" accept=".xlsx,.xls" class="form-control">
<p id="fileError" style="color:red; font-size:14px; margin-top:6px;"></p>


  <label>Font</label>
  <select name="font_choice">
    <option value="1">Helvetica</option>
    <option value="2">Times</option>
    <option value="3">Courier</option>
  </select>

  <div class="checkboxes">
    <label><input type="checkbox" name="include_logo" value="y"> Include MSG Logo</label><br>
    <label><input type="checkbox" name="include_qr" value="y"> Include QR Code</label>
  </div>

  <button type="submit">Generate PDF</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('upload_form');
  const fileInput = document.getElementById('excel_file');

  form.addEventListener('submit', (e) => {
    // 1) file present?
    if (!fileInput.files || fileInput.files.length === 0) {
      e.preventDefault();
      alert('Please choose an Excel file (.xlsx or .xls) first.');
      fileInput.focus();
      return;
    }

    // 2) check extension client-side (nice UX, server still validates)
    const name = fileInput.files[0].name.toLowerCase();
    const allowed = ['.xlsx', '.xls'];
    if (!allowed.some(ext => name.endsWith(ext))) {
      e.preventDefault();
      alert('Invalid file type. Please upload an Excel file (.xlsx or .xls).');
      fileInput.focus();
      return;
    }

    // otherwise allow submit
  });
});
</script>
<script>
const fileInput = document.getElementById('excel_file');
const fileError = document.getElementById('fileError');

fileInput.addEventListener('change', () => {
  const file = fileInput.files[0];
  if (!file) {
    fileError.textContent = "";
    return;
  }

  const allowedExtensions = ['.xlsx', '.xls'];
  const fileName = file.name.toLowerCase();
  const isValid = allowedExtensions.some(ext => fileName.endsWith(ext));

  if (!isValid) {
    fileError.textContent = "Invalid file type. Please upload an Excel file (.xlsx or .xls).";
    fileInput.value = ""; // clear wrong file
  } else {
    fileError.textContent = ""; // clear message if valid
  }
});
</script>


</body>
</html>
